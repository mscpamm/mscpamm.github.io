"use strict";(self["webpackChunkMSCPAMM"]=self["webpackChunkMSCPAMM"]||[]).push([[858],{7858:function(e,a,t){t.r(a),t.d(a,{default:function(){return z}});t(8111),t(7588);var o=t(641),l=t(953),n=t(3751),s=t(33),m=t(2141),d=t(31),u=t(7043),c=t(8982),i=t(3326),r=t(6434),p=t(4335),v=t(8193),f=t(2638);const k={class:"application ft14"},b={class:"app-head"},g={class:"head-left"},U={class:"content"},y={key:0,class:"pamm-info base_box_shadow"},C={class:"upload-name-row"},w={class:"uploader-container"},V={class:"name-container"},A={class:"inline-field"},h={class:"inline-field"},F={key:1,class:"pamm-info base_box_shadow"},L={class:"upload-name-row"},I={class:"uploader-container"},G={class:"name-container"},M={class:"inline-field"},T={class:"inline-field"},S={class:"inline-field"},x={class:"inline-field"},R={class:"inline-field"},P="https://lavender-absent-booby-253.mypinata.cloud",j="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiIwZWNmZWVlNC1kNzE4LTQ4MTMtOWU3NS00YzJkOWMwZGZjOWEiLCJlbWFpbCI6ImdvbGRwYW1tY29pbkBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicGluX3BvbGljeSI6eyJyZWdpb25zIjpbeyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJGUkExIn0seyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJOWUMxIn1dLCJ2ZXJzaW9uIjoxfSwibWZhX2VuYWJsZWQiOmZhbHNlLCJzdGF0dXMiOiJBQ1RJVkUifSwiYXV0aGVudGljYXRpb25UeXBlIjoic2NvcGVkS2V5Iiwic2NvcGVkS2V5S2V5IjoiZjE3MGRhNGEzMTI0NDM4MzUyZmYiLCJzY29wZWRLZXlTZWNyZXQiOiIyMzM4Y2NmZTU4YWMxMTc4OGIxNjE0OWMwNTU4ZDQ0MDkwMzFhZmFmZGNhYjNiNWIxNDI3MmQyZGM5MGIzMjU2IiwiZXhwIjoxNzkwNzI5OTIyfQ.4PHrlidztReaowkVrrLE6WmQwoEOfTsUroCNA2tZVuQ";var D={__name:"index",setup(e){var a=t(5093);const D=(0,u.rd)(),K=(0,l.Kh)(f.n),W=(0,l.KR)(!1),z=(0,l.KR)(!1),Z=((0,l.KR)(""),(0,l.KR)([])),N=(0,l.KR)(10485760),Y=new Date,J=["year","month","day"],X=["hour","minute","second"],_=(0,l.KR)([Y.getFullYear(),Y.getMonth()+1,Y.getDate()]),B=(0,l.KR)([Y.getHours(),Y.getMinutes(),Y.getSeconds()]),O=(0,l.KR)([Y.getFullYear(),Y.getMonth()+1,Y.getDate()]),E=(0,l.KR)([Y.getHours(),Y.getMinutes(),Y.getSeconds()]),Q=(e,a)=>("hour"===e&&(a.text+=":"),"minute"===e&&(a.text+=":"),a),$=((0,l.KR)(0),(0,l.Kh)({name:"",symbol:"",logo:"",desc:"",startTime:"",endTime:""})),H=(0,l.Kh)({token:"",creator:"",name:"",symbol:"",logo:"",desc:"",totalSupply:"",maxBurn:"",totalUsdt:"",daoPerUsdt:"",commonMaxPerUsdt:"",daoUsdt:"",commonUsdt:"",daoLeftUsdt:"",commonLeftUsdt:"",daoInUsdt:"",commonInUsdt:"",totalGpc:"",daoGpc:"",commonGpc:"",lpAmount:"",daoAmount:"",commonAmount:"",leftDaoAmount:"",leftCommontAmount:"",starAmount:"",startTime:"",endTime:"",status:"",sendTime:"",pjStatus:2}),q=(0,l.KR)(0),ee=(0,l.KR)(0),ae=((0,l.KR)("100000"),(0,l.KR)("10000"),(0,l.KR)("地址")),te=(0,l.KR)(!1),oe=(0,l.KR)(!1),le=((0,l.KR)(0),(0,l.KR)(!1)),ne=(0,l.KR)(!1),se=(0,l.KR)(null),me=(0,l.KR)(null),de=(0,l.KR)(""),ue=(0,l.KR)(!1),ce=(0,l.KR)(0);(0,o.sV)(async()=>{await re(),await pe()});const ie=()=>!1,re=async()=>{if(me.value){const e=await me.value.getWalletState();e.isConnected?de.value=e.account:await ve()}},pe=async()=>{const e=await me.value.readContract("mscPamm","getCreatedToken");console.log(e);let a=e[1];ce.value=e[0],z.value=a,a&&await be(ce.value)},ve=async()=>{ue.value=!0;try{if(me.value){const e=await me.value.connectWallet();de.value=e}}catch(e){console.error("连接钱包失败：",e)}finally{ue.value=!1}},fe=e=>{de.value=e.account},ke=({key:e,contract:a})=>{console.log(e,"合约初始化成功：",a.target)},be=async e=>{let t=await me.value.readContract("mscPamm","getPrammTokenInfo",[e]),o={token:t[0],creator:t[1],name:t[2],symbol:t[3],logo:t[4],desc:t[5],totalSupply:t[6],maxBurn:t[7],totalUsdt:t[8],daoPerUsdt:t[9],commonMaxPerUsdt:t[10],daoUsdt:t[11],commonUsdt:t[12],daoLeftUsdt:t[13],commonLeftUsdt:t[14],daoInUsdt:t[15],commonInUsdt:t[16],totalGpc:t[17],daoGpc:t[18],commonGpc:t[19],lpAmount:t[20],daoAmount:t[21],commonAmount:t[22],leftDaoAmount:t[23],leftCommontAmount:t[24],starAmount:t[25],startTime:t[26],endTime:t[27],status:t[28],sendTime:t[29],pjStatus:0};o.totalSupply=m.ck(o.totalSupply),o.totalUsdt=m.ck(o.totalUsdt),o.maxBurn=m.ck(o.maxBurn),o.daoPerUsdt=m.ck(o.daoPerUsdt),o.commonMaxPerUsdt=m.ck(o.commonMaxPerUsdt),o.daoUsdt=m.ck(o.daoUsdt),o.commonUsdt=m.ck(o.commonUsdt),o.daoLeftUsdt=m.ck(o.daoLeftUsdt),o.commonLeftUsdt=m.ck(o.commonLeftUsdt),o.daoInUsdt=m.ck(o.daoInUsdt),o.commonInUsdt=m.ck(o.commonInUsdt),o.totalGpc=m.ck(o.totalGpc),o.daoGpc=m.ck(o.daoGpc),o.commonGpc=m.ck(o.commonGpc),o.lpAmount=m.ck(o.lpAmount),o.daoAmount=m.ck(o.daoAmount),o.commonAmount=m.ck(o.commonAmount),o.leftDaoAmount=m.ck(o.leftDaoAmount),o.leftCommontAmount=m.ck(o.leftCommontAmount),o.starAmount=m.ck(o.starAmount),o.status?o.pjStatus=3:1e3*o.endTime.toString()<(new Date).getTime()?o.pjStatus||(o.pjStatus=4):1e3*o.startTime.toString()<(new Date).getTime()?o.pjStatus=1:1e3*o.startTime.toString()>(new Date).getTime()&&(o.pjStatus=2),H.token=o.token,H.creator=o.creator,H.name=o.name,H.symbol=o.symbol,H.logo=o.logo,H.desc=o.desc,H.totalSupply=o.totalSupply,H.totalUsdt=o.totalUsdt,H.maxBurn=o.maxBurn,H.daoPerUsdt=o.daoPerUsdt,H.commonMaxPerUsdt=o.commonMaxPerUsdt,H.daoUsdt=o.daoUsdt,H.commonUsdt=o.commonUsdt,H.daoLeftUsdt=o.daoLeftUsdt,H.commonLeftUsdt=o.commonLeftUsdt,H.daoInUsdt=o.daoInUsdt,H.commonInUsdt=o.commonInUsdt,H.totalGpc=o.totalGpc,H.daoGpc=o.daoGpc,H.commonGpc=o.commonGpc,H.lpAmount=o.lpAmount,H.daoAmount=o.daoAmount,H.commonAmount=o.commonAmount,H.leftDaoAmount=o.leftDaoAmount,H.leftCommontAmount=o.leftCommontAmount,H.starAmount=o.starAmount,H.startTime=a(1e3*o.startTime.toString()).format("YYYY-MM-DD HH:mm:ss"),H.endTime=a(1e3*o.endTime.toString()).format("YYYY-MM-DD HH:mm:ss"),H.status=o.status,H.sendTime=o.sendTime,H.pjStatus=o.pjStatus,H.timeToStart=o.timeToStart,H.totalU=parseFloat(o.daoUsdt)+parseFloat(o.commonUsdt),console.log(H.totalU);let l=v.J[H.pjStatus]||v.K;H.pjStatusBgColor=l.bgColor,H.pjStatusText=l.text},ge=({contractKey:e,methodName:a,receipt:t})=>{console.log(`交易成功：${a}`,t)},Ue=({scene:e,error:a})=>{console.error(`区块链错误[${e}]：`,a)},ye=async()=>{if(q.value=parseInt(Date.parse($.startTime)/1e3),ee.value=parseInt(Date.parse($.endTime)/1e3),console.log(q.value,ee.value),q.value>ee.value)(0,i.P0)("结束时间必须在开始时间之后");else{if(!$.logo)return(0,i.P0)("请上传logo图"),void(W.value=!0);console.log("验证通过，提交数据"),le.value=!0;try{await me.value.writeContract("mscPamm","addTokenTemp",[$.name,$.symbol,$.logo,$.desc,q.value,ee.value])}catch(e){console.log(e)}le.value=!1}},Ce=async()=>{await me.value.writeContract("mscPamm","sendPairV2",[ce.value,d.b("0x4B9705A0EdE5023Bc916b681B96bbCF4015B4247"),d.b("0x6278FA23Fbe28B9736214E03cf2030F5ee1CCaC9")]),(0,i.P0)("上币成功，币合约地址为:"+ae)},we=()=>{$.startTime=`${_.value.join("-")} ${B.value.join(":")}`,te.value=!1},Ve=()=>{$.endTime=`${O.value.join("-")} ${E.value.join(":")}`,oe.value=!1},Ae=e=>{Array.isArray(e)?e.forEach(e=>he(e)):he(e)},he=e=>{console.log(e),e.status="uploading",e.message="上传中...";const a=new FormData;a.append("file",e.file),a.append("network","public"),p.A.post("https://uploads.pinata.cloud/v3/files",a,{headers:{Authorization:`Bearer ${j}`}}).then(a=>{console.log(a.data);const t=a.data.data.cid;if(!t)throw new Error("Pinata未返回有效CID");const o=`${P}/ipfs/${t}`;$.logo=o,e.status="done",e.url=o}).catch(a=>{console.log(a),e.status="failed",e.message="上传失败"})},Fe=e=>{(0,i.P0)(`图片大小不能超过 ${N.value/1024/1024}MB`)},Le=e=>{Z.value.splice(e,1),W.value=!0,$.logoUrl="",(0,i.P0)("图片已删除")};return(e,a)=>{const t=(0,o.g2)("van-uploader"),m=(0,o.g2)("van-field"),d=(0,o.g2)("van-date-picker"),u=(0,o.g2)("van-time-picker"),i=(0,o.g2)("van-picker-group"),p=(0,o.g2)("van-popup"),v=(0,o.g2)("van-form"),f=(0,o.g2)("van-button"),P=(0,o.g2)("van-cell");return(0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("div",b,[(0,o.Lk)("span",g,[(0,o.Lk)("i",{class:"el-icon-arrow-left",onClick:a[0]||(a[0]=e=>(0,l.R1)(D).go(-1))})]),a[17]||(a[17]=(0,o.Lk)("span",{class:"title"},"我的PAMM",-1))]),(0,o.Lk)("div",U,[z.value?((0,o.uX)(),(0,o.CE)("div",F,[(0,o.Lk)("div",L,[(0,o.Lk)("div",I,[(0,o.bF)((0,l.R1)(r._V),{width:"100",height:"100",src:H.logo},null,8,["src"])]),(0,o.Lk)("div",G,[(0,o.bF)(P,{title:"项目全称",value:H.name,size:"large"},null,8,["value"]),(0,o.bF)(P,{title:"项目简称",value:H.symbol,size:"large"},null,8,["value"])])]),a[26]||(a[26]=(0,o.Lk)("p",{class:"label-title"},"项目简介",-1)),(0,o.bF)(P,{value:H.desc,size:"large"},null,8,["value"]),(0,o.Lk)("div",M,[(0,o.bF)(P,{title:"总发行量",value:H.totalSupply,size:"large"},null,8,["value"])]),(0,o.Lk)("div",T,[(0,o.bF)(P,{title:"总募集U",value:H.totalU,size:"large"},null,8,["value"])]),(0,o.Lk)("div",S,[(0,o.bF)(P,{title:"总募集GPC",value:parseFloat(H.daoGpc)+parseFloat(H.commonGpc),size:"large"},null,8,["value"])]),(0,o.Lk)("div",x,[(0,o.bF)(P,{title:"DAO总募集GPC",value:parseFloat(H.daoGpc),size:"large"},null,8,["value"])]),(0,o.Lk)("div",R,[(0,o.bF)(P,{title:"矿工总募集GPC",value:parseFloat(H.commonGpc),size:"large"},null,8,["value"])]),(0,o.bF)(f,{color:"linear-gradient(45deg, #3567D5, #68A8F0)",style:{width:"200px",margin:"0 auto"},round:"",block:"",type:"info",loading:le.value,"loading-text":"提交中...",onClick:Ce},{default:(0,o.k6)(()=>[...a[25]||(a[25]=[(0,o.eW)(" 提交发射 ",-1)])]),_:1},8,["loading"])])):((0,o.uX)(),(0,o.CE)("div",y,[(0,o.bF)(v,{ref_key:"formRef",ref:se,onSubmit:(0,n.D$)(ie,["prevent"]),required:""},{default:(0,o.k6)(()=>[(0,o.Lk)("div",C,[(0,o.Lk)("div",w,[(0,o.bF)(t,{modelValue:Z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value=e),"after-read":Ae,class:(0,s.C4)({"field-error":ne.value}),deletable:!0,"max-size":N.value,onOversize:Fe,"preview-image":!0,onDelete:Le,"max-count":1,rules:[{required:!0,message:"请上传图片"}]},{default:(0,o.k6)(()=>[(0,o.Lk)("div",{class:(0,s.C4)(["upload-area","ft12",{"error-uploader":W.value}])},[...a[18]||(a[18]=[(0,o.Lk)("p",null,"+",-1),(0,o.Lk)("p",null,"Logo点击上传",-1)])],2)]),_:1},8,["modelValue","class","max-size"])]),(0,o.Lk)("div",V,[(0,o.bF)(m,{modelValue:$.name,"onUpdate:modelValue":a[2]||(a[2]=e=>$.name=e),placeholder:"项目全称,如GoldPammCoin",class:"custom-field",rules:[{required:!0,message:"请输入项目全称"}]},null,8,["modelValue"]),(0,o.bF)(m,{modelValue:$.symbol,"onUpdate:modelValue":a[3]||(a[3]=e=>$.symbol=e),placeholder:"项目简称,如GPC",class:"custom-field",rules:[{required:!0,message:"请输入项目简称"}]},null,8,["modelValue"])])]),a[23]||(a[23]=(0,o.Lk)("p",{class:"label-title"},"项目简介",-1)),(0,o.bF)(m,{modelValue:$.desc,"onUpdate:modelValue":a[4]||(a[4]=e=>$.desc=e),type:"textarea",placeholder:"请输入内容",rows:"3",autosize:"",rules:[{required:!0,message:"请输入项目简介"}],class:"custom-field"},null,8,["modelValue"]),(0,o.Lk)("div",A,[a[19]||(a[19]=(0,o.Lk)("span",{class:"prefix-label time"},"开始时间",-1)),(0,o.bF)(m,{readonly:"",clickable:"",modelValue:$.startTime,"onUpdate:modelValue":a[5]||(a[5]=e=>$.startTime=e),class:"custom-field",placeholder:"选择开始时间,项目开启打新",rules:[{required:!0,message:"请选择开始时间"}],onClick:a[6]||(a[6]=e=>te.value=!0)},null,8,["modelValue"]),a[20]||(a[20]=(0,o.Lk)("span",{class:"suffix-field"},null,-1)),(0,o.bF)(p,{show:te.value,"onUpdate:show":a[10]||(a[10]=e=>te.value=e),position:"bottom"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{title:"开始时间",tabs:["选择日期","选择时间"],onConfirm:we,onCancel:a[9]||(a[9]=e=>te.value=!1)},{default:(0,o.k6)(()=>[(0,o.bF)(d,{modelValue:_.value,"onUpdate:modelValue":a[7]||(a[7]=e=>_.value=e),"columns-type":J},null,8,["modelValue"]),(0,o.bF)(u,{modelValue:B.value,"onUpdate:modelValue":a[8]||(a[8]=e=>B.value=e),formatter:Q,"columns-type":X},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])]),(0,o.Lk)("div",h,[a[21]||(a[21]=(0,o.Lk)("span",{class:"prefix-label time"},"结束时间",-1)),(0,o.bF)(m,{readonly:"",clickable:"",modelValue:$.endTime,"onUpdate:modelValue":a[11]||(a[11]=e=>$.endTime=e),class:"custom-field",placeholder:"结束时间,结束后项目立即上线",rules:[{required:!0,message:"请选择结束时间"}],onClick:a[12]||(a[12]=e=>oe.value=!0)},null,8,["modelValue"]),a[22]||(a[22]=(0,o.Lk)("span",{class:"suffix-field"},null,-1)),(0,o.bF)(p,{show:oe.value,"onUpdate:show":a[16]||(a[16]=e=>oe.value=e),position:"bottom"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{title:"结束时间",tabs:["选择日期","选择时间"],onConfirm:Ve,onCancel:a[15]||(a[15]=e=>oe.value=!1)},{default:(0,o.k6)(()=>[(0,o.bF)(d,{modelValue:O.value,"onUpdate:modelValue":a[13]||(a[13]=e=>O.value=e),"columns-type":J},null,8,["modelValue"]),(0,o.bF)(u,{modelValue:E.value,"onUpdate:modelValue":a[14]||(a[14]=e=>E.value=e),formatter:Q,"columns-type":X},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])])]),_:1},512),(0,o.Lk)("div",null,[(0,o.bF)(f,{color:"linear-gradient(45deg, #3567D5, #68A8F0)",style:{width:"200px",margin:"0 auto"},round:"",block:"",type:"info",loading:le.value,"loading-text":"提交中...",onClick:ye},{default:(0,o.k6)(()=>[...a[24]||(a[24]=[(0,o.eW)(" 提交申请 ",-1)])]),_:1},8,["loading"])])]))]),(0,o.bF)(c.A,{ref_key:"blockchainRef",ref:me,config:K,onWalletConnected:fe,onContractReady:ke,onTxSuccess:ge,onError:Ue},null,8,["config"])])}}},K=t(6262);const W=(0,K.A)(D,[["__scopeId","data-v-c9b26896"]]);var z=W}}]);