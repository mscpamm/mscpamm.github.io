"use strict";(self["webpackChunkMSCPAMM"]=self["webpackChunkMSCPAMM"]||[]).push([[413],{166:function(e,t,a){e.exports=a.p+"static/img/menu2-selected.887cd0f0.png"},829:function(e,t,a){e.exports=a.p+"static/img/menu1.c412536c.png"},1169:function(e){e.exports="data:image/png;base64,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"},2413:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});a(4114),a(8111),a(1701);var n=a(641),o=a(33),l=a(3751),s=a(953),c=a(7043),r=a(8982),i=a(2638),u=a(8193),A=a(31),d=a(2141);const f={class:"home"},g={class:"fixed-head"},v={class:"app-head"},p={class:"title"},m={key:0,class:"main"},h={class:"project"},k={class:"content"},w=["onClick"],y={class:"top"},D={class:"pj-logo left"},R=["src"],K={class:"right"},L={class:"middle"},M={class:"bottom ft13"},T={class:"text fl"},b=["onClick"];var x={__name:"index",setup(e){var t=a(5093);const x=(0,c.rd)(),j=(0,s.KR)(""),B=(0,s.KR)(!1),P=(0,s.KR)(0),S=(0,s.KR)("PAMM"),C=(0,s.KR)(0),E=(0,s.KR)(null),q=(0,s.KR)(null),I=(0,s.KR)(null),z=(0,s.KR)(0),O=(0,s.KR)([]),W=(0,s.KR)(!1),N=(0,s.KR)(!1),H=(0,s.KR)(!1),G=(0,s.Kh)({height:"auto"}),J=(0,s.Kh)(i.n),Y=((0,s.KR)([{src:a(4751)},{src:a(7062)}]),(0,n.EW)(()=>Object.entries(u.J).map(([e,t])=>({value:Number(e),label:t.text}))));(0,n.EW)(()=>{const e=100;return`calc(100vh - ${e}px)`});(0,n.wB)(P,(e,t)=>{}),(0,n.wB)(C,e=>{S.value=4===e?"我的参与":"PAMM"}),(0,n.sV)(async()=>{await U(),await Z(),await _(),oe(0,Y.value[0].value),(0,n.dY)(()=>{setTimeout(()=>{se(),window.addEventListener("resize",se)},100)})}),(0,n.xo)(()=>{window.removeEventListener("resize",se)});const U=async()=>{if(I.value){const e=await I.value.getWalletState();e.isConnected?j.value=e.account:await X()}},Z=async()=>{const e=j.value,t=A.b(e),a=A.b(i.n.contracts[0].address);let n=await I.value.readContract("gpc","allowance",[t,a]);z.value=n},Q=e=>{x.push({path:"/project-detail",query:{id:e}})},V=async e=>{const t=j.value,a=A.b(t),n=A.b(i.n.contracts[0].address);let o=await I.value.readContract("gpc","allowance",[a,n]);z.value=o,o>0||await I.value.writeContract("gpc","approve",[n,d.g5("123456789012345678901234567890")]),x.push({path:"/project-detail",query:{id:e}})},X=async()=>{B.value=!0;try{if(I.value){const e=await I.value.connectWallet();j.value=e}}catch(e){console.error("连接钱包失败：",e)}finally{B.value=!1}},F=e=>{let a=t(1e3*e.toString()).diff(t(),"seconds");a=Math.max(a,0);const n=Math.floor(a/86400);let o=a%86400;const l=Math.floor(o/3600);o%=3600;const s=Math.floor(o/60),c=o%60;let r="";return n>0&&(r+=`${n}天`),(l>0||r)&&(r+=`${l}小时`),(s>0||r)&&(r+=`${s}分钟`),r+=`${c}秒`,console.log(`剩余时间：${r}`),r},_=async()=>{try{if(I.value){const e=await I.value.readContract("mscPamm","getPrammTokens");for(let a=0;a<e.length;a++){console.log(e[a]);let n=t(1e3*e[a][26].toString()).format("YYYY-MM-DD HH:mm:ss"),o=t(1e3*e[a][27].toString()).format("YYYY-MM-DD HH:mm:ss"),l=e[a][28],s=0,c="",r="";l||1e3*e[a][27].toString()<(new Date).getTime()?s=3:parseInt(1e3*e[a][26].toString())<(new Date).getTime()?(s=1,r=F(e[a][27]),console.log(r)):1e3*e[a][27].toString()>(new Date).getTime()&&(s=2,console.log(1e3*e[a][26].toString(),(new Date).getTime()),c=F(e[a][26]));const i=u.J[s]||u.K;console.log(n,o,l,s);let A={pjStatus:s,symbol:e[a][3],name:e[a][2],desc:e[a][5],timeToStart:c,timeToEnd:r,startTime:n,endTime:o,logo:e[a][4],joinFlag:!0,pjStatusText:i.text,iconColor:i.bgColor,btnAction:i.btnAction,timePrefix:i.timePrefix};console.log(A),0==z.value&&2===s?A.btnAction="预约":2==s&&(A.btnAction="详情"),O.value.push(A)}}}catch(e){console.log(e)}},$=e=>{j.value=e.account},ee=({key:e,contract:t})=>{console.log(e,"合约初始化成功：",t.target)},te=({contractKey:e,methodName:t,receipt:a})=>{console.log(`交易成功：${t}`,a)},ae=({scene:e,error:t})=>{console.error(`区块链错误[${e}]：`,t)},ne=e=>e?`${e.slice(0,6)}...${e.slice(-4)}`:"",oe=(e,t)=>{C.value=e,E.value=t},le=()=>{x.push({path:"/application"})},se=()=>{const e=document.querySelector(".fixed-head");if(e&&q.value){const t=e.offsetHeight;G.height=`calc(100vh - ${t}px)`}};return(e,t)=>{const s=(0,n.g2)("van-list"),c=(0,n.g2)("van-pull-refresh");return(0,n.uX)(),(0,n.CE)("div",f,[(0,n.Lk)("div",g,[(0,n.Lk)("div",v,[(0,n.Lk)("span",{class:"head-left",onClick:X},(0,o.v_)(j.value?ne(j.value):"连接钱包"),1),(0,n.Lk)("span",p,(0,o.v_)(S.value),1),(0,n.bo)((0,n.Lk)("span",{class:"head-right",onClick:le},[...t[2]||(t[2]=[(0,n.eW)(" 我的PAMM ",-1),(0,n.Lk)("i",{class:"el-icon-arrow-right"},null,-1)])],512),[[l.aG,!P.value]])]),0===P.value?((0,n.uX)(),(0,n.CE)("div",m,[...t[3]||(t[3]=[(0,n.Lk)("div",{class:"left"},null,-1)])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",{class:"list",ref_key:"myList",ref:q,style:(0,o.Tr)(G)},[(0,n.Lk)("div",h,[(0,n.Lk)("div",k,[(0,n.bF)(c,{modelValue:H.value,"onUpdate:modelValue":t[1]||(t[1]=e=>H.value=e)},{default:(0,n.k6)(()=>[(0,n.bF)(s,{modelValue:W.value,"onUpdate:modelValue":t[0]||(t[0]=e=>W.value=e),finished:N.value,"loading-text":"加载中...","finished-text":"没有更多了",onLoad:e.onLoad},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(O.value,(e,s)=>((0,n.uX)(),(0,n.CE)("div",{class:"box",key:s,onClick:e=>Q(s)},[(0,n.Lk)("div",y,[(0,n.Lk)("span",{class:"absolute",style:(0,o.Tr)({backgroundColor:e.iconColor})},[(0,n.Lk)("span",null,(0,o.v_)(e.pjStatusText),1)],4),(0,n.Lk)("div",D,[(0,n.Lk)("img",{src:e.logo?e.logo:a(1169),alt:""},null,8,R)]),(0,n.Lk)("div",K,[(0,n.Lk)("p",null,(0,o.v_)(e.symbol),1),(0,n.Lk)("p",null,(0,o.v_)(e.name),1)])]),(0,n.Lk)("div",L,[t[4]||(t[4]=(0,n.Lk)("p",{class:"ft15"},"项目简介：",-1)),(0,n.Lk)("p",null,(0,o.v_)(e.desc),1)]),(0,n.Lk)("div",M,[(0,n.Lk)("div",null,[(0,n.Lk)("span",T,(0,o.v_)(e.timePrefix),1),(0,n.bo)((0,n.Lk)("span",{class:"time fl"},(0,o.v_)(e.timeToEnd),513),[[l.aG,1===e.pjStatus]]),(0,n.bo)((0,n.Lk)("span",{class:"time fl"},(0,o.v_)(e.timeToStart),513),[[l.aG,2===e.pjStatus]]),(0,n.bo)((0,n.Lk)("span",{class:"time fl"},(0,o.v_)(e.endTime),513),[[l.aG,3===e.pjStatus]]),(0,n.bo)((0,n.Lk)("div",{class:"btn fr linear-gradient-blue",onClick:(0,l.D$)(e=>V(s),["stop"])},(0,o.v_)(e.btnAction),9,b),[[l.aG,!(3===e.pjStatus&&!e.joinFlag)]])])])],8,w))),128))]),_:1},8,["modelValue","finished","onLoad"])]),_:1},8,["modelValue"])])]),(0,n.bF)(r.A,{ref_key:"blockchainRef",ref:I,config:J,onWalletConnected:$,onContractReady:ee,onTxSuccess:te,onError:ae},null,8,["config"])],4)])}}},j=a(6262);const B=(0,j.A)(x,[["__scopeId","data-v-43a023d2"]]);var P=B},4114:function(e,t,a){var n=a(6518),o=a(8981),l=a(6198),s=a(4527),c=a(6837),r=a(9039),i=r(function(){return 4294967297!==[].push.call({length:4294967296},1)}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},A=i||!u();n({target:"Array",proto:!0,arity:1,forced:A},{push:function(e){var t=o(this),a=l(t),n=arguments.length;c(a+n);for(var r=0;r<n;r++)t[a]=arguments[r],a++;return s(t,a),a}})},4376:function(e,t,a){var n=a(2195);e.exports=Array.isArray||function(e){return"Array"===n(e)}},4527:function(e,t,a){var n=a(3724),o=a(4376),l=TypeError,s=Object.getOwnPropertyDescriptor,c=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=c?function(e,t){if(o(e)&&!s(e,"length").writable)throw new l("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},4751:function(e,t,a){e.exports=a.p+"static/img/menu1-selected.7d37f964.png"},6837:function(e){var t=TypeError,a=9007199254740991;e.exports=function(e){if(e>a)throw t("Maximum allowed index exceeded");return e}},7062:function(e,t,a){e.exports=a.p+"static/img/menu2.e8fedcb5.png"}}]);